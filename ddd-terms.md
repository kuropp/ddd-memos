# ddd-memos

* DDDにおいてデータはエンティティと値オブジェクトに分けられる

## バリューオブジェクト
- 状態を不変に保つ(イミュータブルにする)
- 同じ値オブジェクト同士で値が等しいかどうかの確認ができる(共有できる)
- 完全に交換可能である
- ドメインの要素を属性にしなければならないときにその属性を含むオブジェクトを識別するよりも、どんな属性を含むのかに関心があるもの
- ドメインの１つの側面を表すもので、一意性を保証する必要はない
- 簡単に作成し、破棄できる
- 共通の概念

## エンティティ
- 可変
- 同じ属性でも区別される
- 同一性をもつ
- 一意性である

## サービス
- オブジェクトにも属さないような振る舞い、動詞
- 複数のオブジェクトを横断して作用
- 内部に状態を保持せず、機能だけを提供
- エンティティやバリューオブジェクトに含めると混乱が起こる
- 多くのオブジェクトを結びつけるポイント
- ドメインの概念を表しているが、エンティティやバリューオブジェクトに含めると違和感がある
- ドメイン内の他のオブジェクトから参照される

## モジュール
- コードは高い凝集度と低い結合度を持つべき
- モジュール内の凝集度を高めて、モジュール間の結合度を弱める
- 正確に定義されたインターフェースをもち、他のオブジェクトからアクセスできるのはインターフェイスのみ
- 他の概念とは独立して理解でき、弱く結びついた概念の集まり


## アグリゲート
- オブジェクトの所有権と境界を定義
- 一つのルートをもち、それはエンティティでアグリゲートの外部からアクセスできる唯一のオブジェクト
- アグリゲート内のオブジェクトは直接変更できない、できるのはルートの変更か、ルートに何らかの処理を要求すること
- ルートはアグリゲート内の他のオブジェクトを変更できる
- アグリゲート内のオブジェクト同士は関連してもOK
- ルートとなるエンティティはシステム上で一意、アグリゲート内のオブジェクトはアグリゲート内で一意


## ファクトリ
- オブジェクトの生成時に複雑な処理が入ると設計的に汚い課題を解決する
- オブジェクト作成の複雑な操作をカプセル化
- アグリゲートのルートを作成するときにも便利
- ファクトリメソッドとアブストラクトファクトリ
- ファクトリメソッド
  - 他のオブジェクトを作成するときに必要な知識を保持し隠蔽
  - アグリゲートに属するオブジェクトを作成したいときに役立つ
- ドメインの要素であり、ドメイン以外と関係を持たない
- 新しいオブジェクトだけを作成

## リポジトリ
- DDDでデータの永続化の処理を行うオブジェクト
- エンティティ毎(厳密には集約毎)に用意する
- オブジェクトの参照を取得するのに必要なロジックを全てカプセル化
- どこからでもアクセスできる、オブジェクトの保管場所
-  インフラストラクチャ、データベースと関係を持つ
- 既存のオブジェクトの取得だけを行う

## ユビキタス言語
ドメインモデルを拠り所にした共通言語。の言語をコミュ
ニケーションに、コードにも使うようにチームのメンバに要求。
知識を共有しドメインモデルを構築しているあいだにも、チーム内では
レビューをしたり文書や図を作ったりします。どんな形態のコミュニケーショ
ンであれ、常にこの言語で表現。

## レイヤーアーキテクチャ
ドメインに関係するコードは実際は相対的に量が少ないが、他のレイヤと混ざってはいけない。

- ユーザーインターフェース
  - 画面
- アプリケーションレイヤ
  - 活動を調整する
  - ビジネスロジックを含まない
  - ビジネスオブジェクトの状態を保持しない
- ドメインレイヤ
  - ドメインについての情報を含むソフトウェアの心臓
  - ビジネスオブジェクトの状態を保持
  - ビジネスオブジェクトの永続化処理はインフラに
- インフラストラクチャレイヤ
  - 他の全てのレイヤを補助する
  - レイヤ間の情報のやり取りの制御

## コンテキスト境界
- モデルは１つのチームに割り当てることができるくらい小さくするべき
- モデル分割で大事なのはモデルの範囲を確定すること

## 防腐レイヤ
- 外部のデータと通信する場合に設計を汚さないために置くレイヤ
- クライアントと外部のサービスみたいなもの